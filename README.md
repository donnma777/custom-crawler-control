# 🔒 クローラー個別制御プラグイン

このWordPressプラグインは、投稿・固定ページごとにアクセスするクローラーを細かく制御することを可能にします。デフォルトでは全てのクローラーを許可しますが、「ALL拒否モード」を有効にすることで、特定のAIや検索エンジンのクローラーのみを例外的に許可する運用が可能になります。

特に、AIの学習やデータ収集を目的としたクローラーへのアクセスを制限したい場合に有効です。

## 🌟 主な機能

1.  **ALL拒否モードの切り替え**: 記事編集画面でメインスイッチをONにすると、デフォルトの「全て許可」から「全て拒否」に切り替わります。
2.  **個別許可リスト**: ALL拒否モード有効時、リストからチェックを入れたクローラーのみアクセスが許可される、ホワイトリスト方式を採用しています。
3.  **網羅的なボット定義**: Google、Bing、AI系（GPTBot, Gemini, ClaudeBotなど）、SNSプレビュー系、主要なSEOツール系を含む、**70種類以上**のUAパターンをグループ化して制御対象としています。
4.  **厳格なアクセスチェック**: User-Agentが空のアクセスや、ボットがブラウザに偽装している可能性が高いアクセスは自動的にブロックします。
5.  **API対応**: ブロック時にJSONリクエストであることを検知し、適切に403 ForbiddenのJSONエラーを返します（WordPress REST APIなどへの影響を最小限に抑えます）。

## ⚠️ 重要な免責事項 (保証の限界)

このプラグインは、既知の主要なクローラーのUser-Agent (UA) 文字列を厳密にチェックし、アクセスをブロックします。

しかし、**完全にクローラーのアクセスを防ぐ保証はありません。**

* クローラーは常に新しいUAを使用したり、既存のUAを偽装したりする可能性があります。
* アクセスログ上では通常のブラウザ（Human User）として見せかける高度なスクレイピングツールが存在します。
* 本プラグインの制御ロジックを回避する、未知のアクセス方法が出現する可能性もあります。

本プラグインは、**アクセス制御の労力を最小限に抑え、既知の主要なボットを効果的にブロックする**ことを目的としています。完全な防御が必要な場合は、サーバーレベルでの追加の対策（WAFなど）をご検討ください。

## 🚀 インストール方法

1.  このプラグインのコード（`grok-crawler-control.php`）をZIPファイルに圧縮します。
2.  WordPress管理画面の **プラグイン** > **新規追加** へ移動します。
3.  上部にある **プラグインのアップロード** ボタンをクリックし、作成したZIPファイルを選択してインストールします。
4.  プラグインを有効化します。

## 💡 使用方法

このプラグインの設定は、**投稿** または **固定ページ** の編集画面サイドバーに表示されます。

### 1. デフォルトの状態 (ALL許可)

* 初期状態では、**「ALL拒否モードを有効にする」** チェックボックスはOFFになっています。
* この状態では、全てのクローラーがページにアクセスできます。このモードでチェックリストにチェックを入れても効果はありません。

### 2. アクセスを制御する場合 (ALL拒否モード)

特定のAIクローラーなど、リストにない**すべての**クローラーのアクセスを拒否したい場合に使用します。

1.  編集画面のサイドバーにある **🔒 クローラーアクセス制御設定** メタボックスを見つけます。
2.  **【ALL拒否モードを有効にする】** にチェックを入れます。
3.  下部のリストから、**このページへのアクセスを** **例外的に許可したいクローラー** **のみ** にチェックを入れます。（例: Googlebotだけは許可したい、など）
4.  ページを **更新** または **公開** します。

> ⚠ **注意点**
> ALL拒否モードを有効にし、どのクローラーにもチェックを入れなかった場合、リストに定義されていないすべてのクローラーはアクセスをブロックされます。

## 📝 クローラーリストの例 (設定画面の表示)

設定画面には、以下のカテゴリに分類されたチェックボックスが表示されます。（これは一部の抜粋です）

| カテゴリ | 説明 |
| :--- | :--- |
| Google (検索エンジン & AI全般) | Googlebot, Gemini, GoogleOtherなど |
| GPTBot (OpenAI / ChatGPT) | GPTBot, ChatGPT-Userなど |
| Meta / Facebook (OGP/プレビュー) | facebookexternalhit, MetaBotなど |
| X / Twitter (プレビュー) | Twitterbot, Xbotなど |
| AhrefsBot (SEO分析) | AhrefsBot, AhrefsSiteAuditなど |
| Yandex (ロシア検索) | YandexBot, YandexImagesなど |
| ウェブアーカイブ / データ収集 | archive.org_bot, CCBotなど |


## 📝 作者情報

* **Author**: donnma
* **HP URI**: https://donnma.com/
* **Plugin URI**: https://github.com/donnma777/custom-crawler-control
* **GitHub**: https://github.com/donnma777
* **X**: https://x.com/donnma777
